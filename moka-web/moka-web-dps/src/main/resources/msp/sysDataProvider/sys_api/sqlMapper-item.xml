<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="dps.item">
  <select id="domain_list" parameterType="hashmap" resultType="map">
    SELECT [DOMAIN_ID]
      ,[DOMAIN_NAME]
      ,[DOMAIN_URL]
      ,[SERVICE_PLATFORM]
      ,[USED_YN]
      ,[LANG]
      ,[API_PATH]
      ,[API_HOST]
      ,[DESCRIPTION]
      ,[REG_DT]
      ,[REG_ID]
      ,[MOD_DT]
      ,[MOD_ID] FROM TB_WMS_DOMAIN
  </select>

  <select id="domain_total" parameterType="hashmap" resultType="map">
    SELECT count(1) FROM TB_WMS_DOMAIN
  </select>

  <select id="reserved_list" parameterType="hashmap" resultType="map">
    SELECT [RESERVED_SEQ]
      ,[DOMAIN_ID]
      ,[RESERVED_ID]
      ,[RESERVED_VALUE]
      ,[DESCRIPTION]
      ,[USED_YN]
      ,[REG_DT]
      ,[REG_ID]
      ,[MOD_DT]
      ,[MOD_ID] FROM TB_WMS_RESERVED
    WHERE DOMAIN_ID = #{domainId}
  </select>

  <select id="page_list" parameterType="hashmap" resultType="map">
    <choose>
      <when test='tBody.equalsIgnoreCase("Y") || tBody == null'>
        SELECT [PAGE_SEQ]
        ,[DOMAIN_ID]
        ,[PAGE_NAME]
        ,[PAGE_SERVICE_NAME]
        ,[PAGE_DISPLAY_NAME]
        ,[PARENT_PAGE_SEQ]
        ,[PAGE_TYPE]
        ,[PAGE_URL]
        ,[PAGE_ORD]
        ,[PAGE_BODY]
        ,[URL_PARAM]
        ,[USED_YN]
        ,[FILE_YN]
        ,[KWD]
        ,[CATEGORY]
        ,[DESCRIPTION]
        ,[MOVE_YN]
        ,[MOVE_URL]
        ,[REG_DT]
        ,[REG_ID]
        ,[MOD_DT]
        ,[MOD_ID]
      </when>
      <otherwise>
        SELECT [PAGE_SEQ]
        ,[DOMAIN_ID]
        ,[PAGE_NAME]
        ,[PAGE_SERVICE_NAME]
        ,[PAGE_DISPLAY_NAME]
        ,[PARENT_PAGE_SEQ]
        ,[PAGE_TYPE]
        ,[PAGE_URL]
        ,[PAGE_ORD]
        ,[URL_PARAM]
        ,[USED_YN]
        ,[FILE_YN]
        ,[KWD]
        ,[CATEGORY]
        ,[DESCRIPTION]
        ,[MOVE_YN]
        ,[MOVE_URL]
        ,[REG_DT]
        ,[REG_ID]
        ,[MOD_DT]
        ,[MOD_ID]
      </otherwise>
    </choose>
    FROM TB_WMS_PAGE
    WHERE USED_YN='Y'
    <if test="domainId != null">AND DOMAIN_ID = #{domainId}</if>
    <if test="id != null">AND PAGE_SEQ = #{id}</if>
  </select>

  <select id="container" parameterType="hashmap" resultType="map">
    SELECT [CONTAINER_SEQ]
      ,[DOMAIN_ID]
      ,[CONTAINER_NAME]
      ,[CONTAINER_BODY]
      ,[REG_DT]
      ,[REG_ID]
      ,[MOD_DT]
      ,[MOD_ID] FROM TB_WMS_CONTAINER
	WHERE CONTAINER_SEQ = #{id}
  </select>

  <select id="component" parameterType="hashmap" resultType="map">
    SELECT [COMPONENT_SEQ]
      ,[DOMAIN_ID]
      ,[TEMPLATE_SEQ]
      ,[DATASET_SEQ]
      ,[PART_SEQ]
      ,[COMPONENT_NAME]
      ,[DESCRIPTION]
      ,[PERIOD_YN]
      ,[PERIOD_START_DT]
      ,[PERIOD_END_DT]
      ,[DATA_TYPE]
      ,[DEL_WORDS]
      ,[PAGING_YN]
      ,[PAGING_TYPE]
      ,[PER_PAGE_COUNT]
      ,[MAX_PAGE_COUNT]
      ,[DISP_PAGE_COUNT]
      ,[MORE_COUNT]
      ,[SCH_CODE_ID]
      ,[VIEW_YN]
      ,[SNAPSHOT_YN]
      ,[SNAPSHOT_BODY]
      ,[ART_PAGE_SEQ]
      ,[REG_DT]
      ,[REG_ID]
      ,[MOD_DT]
      ,[MOD_ID] FROM TB_WMS_COMPONENT
	WHERE COMPONENT_SEQ = #{id}
  </select>

  <select id="component_work" parameterType="hashmap" resultType="map">
	SELECT 
	  c.COMPONENT_SEQ,
	  c.DOMAIN_ID,
	  (CASE WHEN w.SEQ IS NULL THEN c.TEMPLATE_SEQ ELSE w.TEMPLATE_SEQ END) AS TEMPLATE_SEQ,
	  c.DATASET_SEQ,
	  c.PART_SEQ,
	  c.COMPONENT_NAME,
	  c.DESCRIPTION,
	  c.PERIOD_YN,
	  c.PERIOD_START_DT,
	  c.PERIOD_END_DT,
	  c.DATA_TYPE,
	  c.DEL_WORDS,
	  c.PAGING_YN,
	  c.PAGING_TYPE,
	  (CASE WHEN w.SEQ IS NULL THEN c.PER_PAGE_COUNT ELSE w.PER_PAGE_COUNT END) AS PER_PAGE_COUNT,
	  c.MAX_PAGE_COUNT,
	  c.DISP_PAGE_COUNT,
	  c.MORE_COUNT,
	  c.SCH_CODE_ID,
	  (CASE WHEN w.SEQ IS NULL THEN c.VIEW_YN ELSE w.VIEW_YN END) AS VIEW_YN,
	  (CASE WHEN w.SEQ IS NULL THEN c.SNAPSHOT_YN ELSE w.SNAPSHOT_YN END) AS SNAPSHOT_YN,
	  (CASE WHEN w.SEQ IS NULL THEN c.SNAPSHOT_BODY ELSE w.SNAPSHOT_BODY END) AS SNAPSHOT_BODY,
	  c.ART_PAGE_SEQ,
	  w.REG_DT,
	  (CASE WHEN w.SEQ IS NULL THEN c.REG_ID ELSE w.REG_ID END) AS REG_ID,
	  (CASE WHEN w.SEQ IS NULL THEN c.MOD_DT ELSE w.REG_DT END) AS REG_DT,
	  (CASE WHEN w.SEQ IS NULL THEN c.MOD_ID ELSE w.REG_ID END) AS MOD_ID
	FROM TB_WMS_COMPONENT c
	LEFT OUTER JOIN TB_WMS_COMPONENT_WORK w
	  ON c.COMPONENT_SEQ = w.COMPONENT_SEQ AND w.REG_ID = #{regId}
	WHERE  c.COMPONENT_SEQ = #{id}
  </select>

  <select id="template" parameterType="hashmap" resultType="map">
    SELECT [TEMPLATE_SEQ]
      ,[DOMAIN_ID]
      ,[TEMPLATE_NAME]
      ,[TEMPLATE_BODY]
      ,[CROP_WIDTH]
      ,[CROP_HEIGHT]
      ,[TEMPLATE_GROUP]
      ,[TEMPLATE_WIDTH]
      ,[TEMPLATE_THUMB]
      ,[DESCRIPTION]
      ,[REG_DT]
      ,[REG_ID]
      ,[MOD_DT]
      ,[MOD_ID] FROM TB_WMS_TEMPLATE
	WHERE TEMPLATE_SEQ = #{id}
  </select>

  <select id="articlePage" parameterType="hashmap" resultType="map">
    SELECT [ART_PAGE_SEQ]
      ,[DOMAIN_ID]
      ,[ART_TYPE]
      ,[ART_PAGE_NAME]
      ,[ART_PAGE_BODY]
      ,[REG_DT]
      ,[REG_ID]
      ,[MOD_DT]
      ,[MOD_ID] FROM TB_WMS_ARTICLE_PAGE
    WHERE ART_PAGE_SEQ = #{id}
  </select>

  <select id="cdnArticleList" parameterType="hashmap" resultType="map">
    SELECT TOTAL_ID, CDN_URL_NEWS, CDN_URL_MNEWS
    FROM TB_CDN_ARTICLE
    WHERE USED_YN = 'Y'
  </select>

  <select id="articlePageId" parameterType="hashmap" resultType="map">
    SELECT [ART_PAGE_SEQ]
    FROM TB_WMS_ARTICLE_PAGE
    WHERE DOMAIN_ID= #{domainId} AND ART_TYPE = #{artType}
  </select>

  <select id="dataset" parameterType="hashmap" resultType="map">
    SELECT [DATASET_SEQ]
      ,[DATASET_NAME]
      ,[DATA_API_PATH]
      ,[DATA_API_HOST]
      ,[DATA_API]
      ,[DATA_API_PARAM]
      ,[DESCRIPTION]
      ,[AUTO_CREATE_YN]
      ,[REG_DT]
      ,[REG_ID]
      ,[MOD_DT]
      ,[MOD_ID] FROM TB_WMS_DATASET
	WHERE  DATASET_SEQ = #{id}
  </select>

  <select id="ad" parameterType="hashmap" resultType="map">
    SELECT [AD_SEQ]
      ,[DOMAIN_ID]
      ,[AD_NAME]
      ,[AD_DEPT_NO]
      ,[AD_USE_TYPE]
      ,[AD_LOCATION]
      ,[PERIOD_YN]
      ,[PERIOD_START_DT]
      ,[PERIOD_END_DT]
      ,[USED_YN]
      ,[AD_WIDTH]
      ,[AD_HEIGHT]
      ,[DESCRIPTION]
      ,[AD_TYPE]
      ,[SLIDE_TYPE]
      ,[AD_BODY]
      ,[AD_FILE_NAME]
      ,[REG_DT]
      ,[REG_ID]
      ,[MOD_DT]
      ,[MOD_ID] FROM TB_WMS_AD
	WHERE AD_SEQ = #{id}
  </select>
</mapper>
